<link href="../css/complaint_form.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAprQv_1poHHjDfhRmJ3j742-JRWCfAF7o&libraries=places"
  type="text/javascript">
  </script>
<div class="container">
  <form action="action_page.php">
    <div class="row">
      <div class="col-25">
        <label for="fname">Subject</label>
      </div>
      <div class="col-75">
        <input type="text" id="fname" name="Subject" placeholder="Subject..">
      </div>
    </div>
    <div class="row">
      <div class="col-25">
        <label for="subject">Description</label>
      </div>
      <div class="col-75">
        <textarea id="subject" name="subject" placeholder="Write something.." style="height:200px"></textarea>
      </div>
    </div>
    <p>Upload an image of the problem:
      <input type="file" id="myFile" name="filename">
    </p>
    <div class="mapsize">
      <div id="map-canvas"></div>
    </div>
    <input type="text" class="form-control input-sm" style="display:none;" name="lat" id="lat">
    <input type="text" class="form-control input-sm" style="display:none;" name="lng" id="lng">

    <div class="row">
      <input type="submit" value="Submit">
    </div>
  </form>
</div>





<script>
  var lati, lngi;
  window.addEventListener("load", (event) => {
    getLocation();
  });


  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);

    } else {

    }
  }

  function showPosition(position) {
    lati = position.coords.latitude;
    lngi = position.coords.longitude;
    map_start(lati, lngi);
  }

  function map_start(lati, lngi) {
    var map = new google.maps.Map(document.getElementById('map-canvas'), {
      center: {
        lat: lati,
        lng: lngi
      },
      zoom: 15
    });
    var marker = new google.maps.Marker({
      position: {
        lat: lati,
        lng: lngi
      },
      map: map,
      draggable: true
    });

    map.addListener('click', function (e) {
      placeMarker(e.latLng, map);
    });
  }
  function placeMarker(position, map) {
    if (marker)
      marker.setMap(null);
    console.log(position.lat(), position.lng());
    marker = new google.maps.Marker({
      position: position,
      map: map
    });
    map.panTo(position);
  }
</script>